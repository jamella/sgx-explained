X Layers
X - SMM
X - VMX root
X - Ring 0
X - Ring 3

X Multi-core
X - cores
X - hyper-threads: logical processors
X - processor and core layout
- APIC, local APIC, bus
- IPI

X Paging
X - 4-level structure
X - EPT
- faults

X Caching
X - geometry
X - what is specified in x86
- interaction with paging

X PRM
X - restrictions
X - set up at boot time

X EPC
X - 4kb pages
X - in PRM
- supposedly encrypted
X - backed by EPCM

X EPCM
X - metadata
- page types
- instructions

X SECS
X - specified in RAM, unspecified in EPC
- arch features
X - EID
- MRENCLAVE
- measuring state
- probably used to sync ops

TCS
- per thread
- entry point in enclave
- per/thread data (FS/GS)
- list of SSAs

SSA
- GPRs
- extended state (XSAVE)
- page-aligned and sized

VA
- array of nonces
- can be evicted itself, creating a tree

EINITTOKEN
- role in attestation

SIGSTRUCT
- role in attestation

EREPORT
- attestation process

X ECREATE
X - EPC impact
- crypto setup

X EADD
X - EPC impact
- copying

EPT
- EPC impact

EEXTEND
- crypto impact

EINIT
- crypto checks

EENTER
- TCS/SSA checks and impact
- register impact

EEXIT
- register impact
- TCS impact

AEX
- use of SSA
- complete interrupt handling

ERESUME
- spec
- negative impact on security
- describe removing and using exception-handling TCS instead

EBLOCK
- EPCM impact

ETRACK
- checks, counter
- IPI

EWB
- ETRACK checks
- VA checks
- crypto process

ELDU, ELDB
- crypto checks
- VA clear
- analysis of crypto

EREPORT
- attestation crypto

EGETKEY
- key derivation
- uses

Threat Model
- chip trusted
- on-chip key
- some protection against hardware attacks
- software -> hardware attack via extra processor
- no side-channel protection

Attestation Model
- covers initial enclave state
- initial state is all public
- the signing enclave and inter-enclave attestation
- crypto
- key derivation
- enclaves cannot be moved across processes

Page-Level Memory Access Patterns

Cache Line-Level Memory Access Patterns
- cache coloring
- attack and analysis
